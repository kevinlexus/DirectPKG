create table EXS.DEBT_SUB_REQUEST
(
  id                   NUMBER not null,
  request_number       VARCHAR2(30),
  request_guid         VARCHAR2(36),
  first_name           VARCHAR2(50),
  last_name            VARCHAR2(50),
  middle_name          VARCHAR2(50),
  snils                VARCHAR2(11),
  doc_seria            VARCHAR2(20),
  doc_number           VARCHAR2(20),
  doc_type_guid        VARCHAR2(36),
  address              VARCHAR2(100),
  address_detail       VARCHAR2(100),
  status_gis           NUMBER,
  sent_date            DATE,
  response_date        DATE,
  has_debt             INTEGER default 0,
  executor_guid        VARCHAR2(36),
  executor_fio         VARCHAR2(100),
  dt_crt               DATE,
  dt_upd               DATE,
  fk_user              NUMBER,
  org_from_guid        VARCHAR2(36),
  org_from_name        VARCHAR2(500),
  org_from_phone       VARCHAR2(30),
  status               NUMBER,
  response_status      NUMBER,
  fk_eolink_house      NUMBER,
  sel                  NUMBER default 0,
  fk_user_response     NUMBER,
  description          VARCHAR2(1000),
  result               VARCHAR2(1024),
  tguid                VARCHAR2(36),
  is_revoked           NUMBER default 0,
  is_error_on_response NUMBER default 0,
  fk_uk                NUMBER not null,
  fk_proc_uk           NUMBER
)
tablespace DATA
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
comment on table EXS.DEBT_SUB_REQUEST
  is 'Запросы о задолженности от УСЗН';
comment on column EXS.DEBT_SUB_REQUEST.request_number
  is 'Номер запроса, присвоенный в ГИС ЖКХ';
comment on column EXS.DEBT_SUB_REQUEST.request_guid
  is 'Идентификатор запроса, присвоенный в ГИС ЖКХ';
comment on column EXS.DEBT_SUB_REQUEST.first_name
  is 'Имя';
comment on column EXS.DEBT_SUB_REQUEST.last_name
  is 'Фамилия';
comment on column EXS.DEBT_SUB_REQUEST.middle_name
  is 'Отчество';
comment on column EXS.DEBT_SUB_REQUEST.snils
  is 'СНИЛС';
comment on column EXS.DEBT_SUB_REQUEST.doc_seria
  is 'Серия документа';
comment on column EXS.DEBT_SUB_REQUEST.doc_number
  is 'Номер документа';
comment on column EXS.DEBT_SUB_REQUEST.doc_type_guid
  is 'GUID документа (НСИ #95)';
comment on column EXS.DEBT_SUB_REQUEST.address
  is 'Адресная строка';
comment on column EXS.DEBT_SUB_REQUEST.address_detail
  is 'Дополнительная информация об ОЖФ (номер квартиры / помещения, комнаты, блока жилого дома)';
comment on column EXS.DEBT_SUB_REQUEST.status_gis
  is 'Статус запроса в ГИС ЖКХ (0- Sent , отправлено в УК, 1-Processed, обработка  (чья???), 2-Revoked, отозвано отправившей организацией)';
comment on column EXS.DEBT_SUB_REQUEST.sent_date
  is 'Дата направления запроса поставщикам ЖКУ';
comment on column EXS.DEBT_SUB_REQUEST.response_date
  is 'Крайний срок ответа на запрос';
comment on column EXS.DEBT_SUB_REQUEST.has_debt
  is 'Признак наличия задолженности, подтвержденной судебным актом (0-нет, 1-есть) (Заполняется со стороны УК)';
comment on column EXS.DEBT_SUB_REQUEST.executor_guid
  is 'Идентификатор исполнителя, GUID, направивший запрос';
comment on column EXS.DEBT_SUB_REQUEST.executor_fio
  is 'ФИО Исполнителя, направивший запрос';
comment on column EXS.DEBT_SUB_REQUEST.dt_crt
  is 'Дата создания записи';
comment on column EXS.DEBT_SUB_REQUEST.dt_upd
  is 'Дата обновления записи';
comment on column EXS.DEBT_SUB_REQUEST.fk_user
  is 'Пользователь, кто создал запись';
comment on column EXS.DEBT_SUB_REQUEST.org_from_guid
  is 'GUID Организации, направившей запрос';
comment on column EXS.DEBT_SUB_REQUEST.org_from_name
  is 'Наименование организации, направившей запрос';
comment on column EXS.DEBT_SUB_REQUEST.org_from_phone
  is 'Телефон организации, направившей запрос';
comment on column EXS.DEBT_SUB_REQUEST.status
  is 'Статус загрузки в ГИС (0-принято УК от ГИС, 1-изменено и подготовлено к отправке в ГИС,2-Выполнение отправки в ГИС)';
comment on column EXS.DEBT_SUB_REQUEST.response_status
  is 'Статус ответа на запрос (0-NotSent, 1-Sent, 2-AutoGenerated)';
comment on column EXS.DEBT_SUB_REQUEST.fk_eolink_house
  is 'FK на объект Eolink - дом';
comment on column EXS.DEBT_SUB_REQUEST.sel
  is 'Отмечено для отправки в ГИС (0-не отмечено, 1 - отмечено)';
comment on column EXS.DEBT_SUB_REQUEST.fk_user_response
  is 'Пользователь, отправивший ответ на запрос (Заполняется со стороны УК)';
comment on column EXS.DEBT_SUB_REQUEST.description
  is 'Дополнительная информация по ответу (Заполняется со стороны УК)';
comment on column EXS.DEBT_SUB_REQUEST.result
  is 'Последний результат отправки в ГИС';
comment on column EXS.DEBT_SUB_REQUEST.tguid
  is 'ГИС ЖКХ Транспортный GUID';
comment on column EXS.DEBT_SUB_REQUEST.is_revoked
  is 'Отозвано (0-нет, 1-да) (Заполняется со стороны УК)';
comment on column EXS.DEBT_SUB_REQUEST.is_error_on_response
  is 'Ошибка при отправке ответа в ГИС (0-нет,1-да)';
comment on column EXS.DEBT_SUB_REQUEST.fk_uk
  is 'FK на УК (для которой предназначен запрос)';
comment on column EXS.DEBT_SUB_REQUEST.fk_proc_uk
  is 'FK на объект Eolink - УК (для которой предназначен запрос)';
alter table EXS.DEBT_SUB_REQUEST
  add constraint DEBT_SUB_REQUEST_PK primary key (ID)
  using index 
  tablespace DATA
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EXS.DEBT_SUB_REQUEST
  add constraint DEBT_SUB_REQUEST_F_EOLINK foreign key (FK_EOLINK_HOUSE)
  references EXS.EOLINK (ID);
alter table EXS.DEBT_SUB_REQUEST
  add constraint DEBT_SUB_REQUEST_F_EOLINK_UK foreign key (FK_PROC_UK)
  references EXS.EOLINK (ID);
alter table EXS.DEBT_SUB_REQUEST
  add constraint DEBT_SUB_REQUEST_F_T_ORG foreign key (FK_UK)
  references T_ORG (ID);
alter table EXS.DEBT_SUB_REQUEST
  add constraint DEBT_SUB_REQUEST_F_USER_RESP foreign key (FK_USER_RESPONSE)
  references T_USER (ID);

